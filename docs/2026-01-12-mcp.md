## MCP任务显示界面 - 技术设计方案

### 项目技术栈
- **框架**: Vue 3 + TypeScript
- **构建工具**: Vite
- **UI组件**: 自定义组件 + Element Plus (基础组件)
- **Markdown渲染**: marked + highlight.js
- **画布交互**: 原生Canvas/SVG + 自定义拖拽系统

---

### 界面布局 (三栏式)

```
┌─────────────┬──────────────────────────────┬─────────────────┐
│  左侧面板    │        中间画布面板           │    右侧面板      │
│  (250px)    │        (flex: 1)             │    (350px)      │
│             │                              │                 │
│ 状态机列表   │   蓝图风格任务流程图           │  详细信息面板    │
│             │   (可拖拽/缩放画布)           │                 │
│ - 状态机1   │                              │  - 任务ID       │
│ - 状态机2   │   ┌────┐    ┌────┐          │  - 任务状态     │
│ - 状态机3   │   │模块1│───→│模块2│          │  - 模块任务MD   │
│             │   └──┬─┘    └────┘          │  - 测试文档     │
│             │      │                       │                 │
│             │   ┌──┴─┐                     │                 │
│             │   │阶段1│                     │                 │
│             │   └────┘                     │                 │
└─────────────┴──────────────────────────────┴─────────────────┘
```

---

### 核心功能模块

#### 1. 左侧任务列表面板 (`TaskListPanel.vue`)
- 显示所有状态机列表
- 每个状态机显示：名称、状态图标、运行状态
- 单击选中 → 中间画布显示该状态机的任务流程
- 右侧面板显示状态机详情

#### 2. 中间蓝图画布面板 (`BlueprintCanvas.vue`)
- **画布功能**:
  - 鼠标拖拽移动画布
  - 滚轮缩放
  - 自动居中/适应视图
- **节点系统**:
  - 模块任务节点 (主节点，横向排布)
  - 阶段任务节点 (紧贴在模块任务下方)
- **连接线**:
  - SVG贝塞尔曲线连接
  - 光影流动动画 (CSS动画 + SVG渐变)
  - 流向箭头指示

#### 3. 右侧详细面板 (`DetailPanel.vue`)
- **状态机详情模式**: 显示状态机整体信息
- **任务节点详情模式**:
  - 任务ID
  - 任务状态 (带颜色标识)
  - 模块任务描述 (Markdown渲染)
  - 测试文档信息 (Markdown渲染)

#### 4. 任务详情弹窗 (`TaskDetailModal.vue`)
- 双击模块任务节点触发
- 新窗口/模态框显示完整任务详情
- 包含所有阶段任务的详细信息

---

### 文件结构

```
D:\Project\AIProject\AIView\
├── index.html
├── package.json
├── vite.config.ts
├── tsconfig.json
├── src/
│   ├── main.ts
│   ├── App.vue
│   ├── types/
│   │   └── task.ts              # 类型定义
│   ├── stores/
│   │   └── taskStore.ts         # 状态管理
│   ├── components/
│   │   ├── layout/
│   │   │   └── MainLayout.vue   # 主布局
│   │   ├── panels/
│   │   │   ├── TaskListPanel.vue    # 左侧面板
│   │   │   ├── BlueprintCanvas.vue  # 中间画布
│   │   │   └── DetailPanel.vue      # 右侧面板
│   │   ├── blueprint/
│   │   │   ├── ModuleNode.vue       # 模块任务节点
│   │   │   ├── PhaseNode.vue        # 阶段任务节点
│   │   │   └── ConnectionLine.vue   # 连接线组件
│   │   └── modals/
│   │       └── TaskDetailModal.vue  # 详情弹窗
│   ├── composables/
│   │   ├── useCanvas.ts         # 画布拖拽/缩放
│   │   └── useMarkdown.ts       # Markdown渲染
│   └── styles/
│       ├── variables.css        # CSS变量
│       ├── blueprint.css        # 蓝图样式
│       └── animations.css       # 动画效果
└── public/
    └── mock/
        └── tasks.json           # 模拟数据
```

---

### 连接线光影动画实现

```css
/* 流动光影效果 */
@keyframes flowAnimation {
  0% { stroke-dashoffset: 20; }
  100% { stroke-dashoffset: 0; }
}

.connection-line {
  stroke: url(#flowGradient);
  stroke-width: 3;
  stroke-dasharray: 10 5;
  animation: flowAnimation 1s linear infinite;
  filter: drop-shadow(0 0 4px rgba(0, 150, 255, 0.6));
}
```

---

### 数据结构设计

```typescript
interface StateMachine {
  id: string;
  name: string;
  status: 'running' | 'paused' | 'completed' | 'error';
  modules: ModuleTask[];
}

interface ModuleTask {
  id: string;
  name: string;
  status: TaskStatus;
  description: string;      // Markdown内容
  testDocument: string;     // Markdown测试文档
  phases: PhaseTask[];
  position: { x: number; y: number };
}

interface PhaseTask {
  id: string;
  name: string;
  status: TaskStatus;
  details: string;
}

type TaskStatus = 'pending' | 'running' | 'completed' | 'failed';
```

---

### 实现步骤

1. **初始化项目** - 创建Vue3+Vite+TS项目结构
2. **创建类型定义** - 定义任务相关的TypeScript接口
3. **实现主布局** - 三栏式响应布局
4. **左侧面板** - 状态机列表组件
5. **中间画布** - 蓝图系统核心
   - 画布拖拽/缩放
   - 节点渲染
   - 连接线动画
6. **右侧面板** - 详情展示 + Markdown渲染
7. **弹窗组件** - 双击打开详情窗口
8. **样式优化** - 蓝图风格UI + 动画效果

---

是否确认此方案并开始实现？