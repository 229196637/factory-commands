---
name: solutions-lookup
description: 查询项目历史解决方案和踩坑记录。当用户提到"之前修复过"、"之前动过"、"以前遇到过"、"踩过坑"、"历史问题"等关键词时使用。
---

# 解决方案查询

查询 `.factory/docs/solutions/` 目录中的历史解决方案，帮助避免重复踩坑。

## 触发场景

- 用户说"之前修复过"、"之前动过"、"以前遇到过"
- 用户说"踩过坑"、"历史问题"、"之前的解决方案"
- 用户说"有没有类似问题"、"查一下知识库"
- 遇到问题时想查看是否有历史记录

---

## Phase 1: 扫描解决方案目录

### 1.1 检查目录

```
使用 LS 工具查看: <项目根目录>/.factory/docs/solutions/
```

### 1.2 列出所有解决方案

使用 Glob 工具查找所有解决方案文件：
```
模式: .factory/docs/solutions/**/*.md
```

---

## Phase 2: 搜索匹配

### 2.1 关键词搜索

根据用户描述的问题，使用 Grep 搜索匹配的解决方案：

| 搜索范围 | 说明 |
|---------|------|
| 标题 | 问题的简短描述 |
| tags | YAML frontmatter 中的标签 |
| 问题描述 | 问题现象 |
| 原因 | 根本原因 |

### 2.2 读取匹配文件

对于匹配的文件，使用 Read 工具读取完整内容。

---

## Phase 3: 输出报告

### 3.1 找到匹配时

```markdown
## 找到相关解决方案

### [S001] 问题标题
- **问题**: 一句话描述
- **原因**: 根本原因
- **解决**: 解决方案
- **避坑**: 如何避免

---

### [S002] 另一个问题
...
```

### 3.2 未找到匹配时

```markdown
## 未找到相关解决方案

知识库中暂无匹配的历史记录。

**建议**:
1. 尝试使用不同的关键词搜索
2. 解决问题后，使用 `/compound` 命令记录此解决方案
```

---

## 边界情况处理

### 情况1: solutions 目录不存在

```
提示: .factory/docs/solutions/ 目录不存在。
建议: 使用 `/compound` 命令记录第一个解决方案，目录会自动创建。
```

### 情况2: 目录为空

```
提示: 知识库为空，暂无历史解决方案。
建议: 解决问题后，使用 `/compound` 命令记录。
```

---

## 与其他命令的配合

```
遇到问题 → [solutions-lookup] 查询历史
    ↓
未找到 → 解决问题
    ↓
解决后 → /compound 记录解决方案
    ↓
下次遇到 → [solutions-lookup] 可以找到
```

---

## 使用示例

### 示例1: 查询特定问题
```
用户: 这个 nil 崩溃之前遇到过吗？
AI:
1. 搜索 solutions 目录中包含 "nil" 的文件
2. 展示匹配的解决方案
```

### 示例2: 查询标签
```
用户: 有没有关于 UI 的坑？
AI:
1. 搜索 tags 包含 "ui" 的解决方案
2. 列出所有匹配项
```

### 示例3: 模糊查询
```
用户: 之前动画系统好像有个问题
AI:
1. 搜索包含 "动画" 或 "animation" 的解决方案
2. 展示相关记录
```
